{% load static %}
<!DOCTYPE html>
<html lang="ja">
   <head>
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <title>Home</title>
      <link rel="stylesheet" href="{% static 'css/style.css' %}">
      <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
   </head>
  
   <body>
       
       <div class="parallelogram">
        <h1>5eDRIVE</h1>
        </div>
        <header class="header-container">
      <nav class="navbar navbar-expand-lg navbar-light bg-light">
        <a class="navbar-brand" href="{% url 'Edrive:my_car' user.pk %}">マイカー</a>
        <a class="navbar-brand" href="{% url 'Edrive:mypage' user.pk %}">マイページ</a>
        <div class="logo">
        <a href="{% url 'Edrive:home' %}" class="home-link">
             <img src = "{% get_media_prefix %}shinryoku.png"  alt = "ホーム">
             <p>HOME</p>
        </a>
        </div>
        <a class="navbar-brand" href="{% url 'Edrive:eco_car_site' %}">エコカー関連サイト</a>
        <a class="navbar-brand" href="{% url 'Edrive:login' %}">ログアウト</a>
      </nav>
      </header>
      {% block content %}{% endblock %}

    <div class="achievement-info">
    <div class="droplet"></div>
    <p>あと{{ target_achievement_count }}回目標達成でレベルアップ</p>
    <p>現在のドライバーレベル<span class="current-level">{{ user.driver_level }}</span></p>
    </div>

    <div class="achievement-container">
        <div class="target-achievement">
            <h4>目標燃費量</h4>
    {% for my_car in my_cars %}
         <div class="value">{{ my_car.target_fuel_efficiency }}km/L</div>
    {% endfor %}

    </div>
        <div class="actual-achievement">
            <h4>実績燃費量</h4>
    {% for record in fuel_records %}
          <div class="value">{{ record.fuel_efficiency|floatformat:1 }}km/L</div>
    {% endfor %}
   </div>
   </div>
  <div class="nav-links">
    <a class="navbar-brand" href="{% url 'Edrive:records' user.pk %}">燃費入力</a>
    <a class="navbar-brand" href="{% url 'Edrive:target_fuelefficiency' user.pk %}">目標燃費量入力</a>
  </div>

  <div id="chart-container">
  <div style="width: 80%; margin: 0 auto;">
        <canvas id="fuelChart"></canvas>
    </div>
    </div>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script>
        var ctx = document.getElementById('fuelChart').getContext('2d');
        var fuelChart = new Chart(ctx, {
            type: 'line',
            data: {
                labels: {{ labels|safe }},
                datasets: [{
                    label: '燃費量',
                    data: {{ data|safe }},
                    backgroundColor: 'rgba(75, 192, 192, 0.2)',
                    borderColor: 'rgba(75, 192, 192, 1)',
                    borderWidth: 1
                }]
            },
            options: {
                scales: {
                    y: {
                        beginAtZero: true
                    }
                }
            }
        });
    </script>
</body>
</html>
   
